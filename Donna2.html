$index = "C:\Users\Pnich\Desktop\Donna_Jones_TopTier\index.html"
$html  = Get-Content $index -Raw

###############################################################
# 1. REMOVE ALL OLD SNOW BLOCKS
###############################################################
$html = $html -replace '<script id=.clean-snow-script.[\s\S]*?</script>', ''
$html = $html -replace '<script id=.simple-snow.[\s\S]*?</script>', ''
$html = $html -replace 'bigflake[\s\S]*?}', ''
$html = $html -replace 'smalldot[\s\S]*?}', ''
$html = $html -replace 'glitterflake[\s\S]*?}', ''


###############################################################
# 2. ADD FALLING BIG SNOWFLAKES + SMALL DOTS + HEAVY GLITTER
###############################################################

$snow = @"
<style>
/* Big ❄ flakes */
.bigflake {
  position: fixed;
  top: -10px;
  pointer-events: none;
  color: white;
  font-size: 30px;
  opacity: 0.9;
  animation: fallBig linear infinite;
  z-index: 9999;
}
@keyframes fallBig {
  to { transform: translateY(110vh); }
}

/* Small white round flakes */
.smalldot {
  position: fixed;
  top: -10px;
  border-radius: 50%;
  background: white;
  pointer-events: none;
  z-index: 9999;
  opacity: 0.8;
  animation: fallSmall linear infinite;
}
@keyframes fallSmall {
  to { transform: translateY(110vh); }
}

/* Heavy glitter sparkles */
.glitterflake {
  position: fixed;
  top: -10px;
  pointer-events: none;
  border-radius: 50%;
  animation: fallGlitter linear infinite, glitterPulse 1.8s infinite ease-in-out;
  z-index: 9998;
}
@keyframes fallGlitter {
  to { transform: translateY(110vh); }
}
@keyframes glitterPulse {
  0% { opacity: 0.1; transform: scale(0.6); }
  50% { opacity: 1; transform: scale(1.4); }
  100% { opacity: 0.1; transform: scale(0.6); }
}
</style>

<script id="clean-snow-script">
document.addEventListener("DOMContentLoaded", function () {

    /* BIG SNOWFLAKES */
    for (let i = 0; i < 22; i++) {
        let f = document.createElement("div");
        f.className = "bigflake";
        f.textContent = "❄";
        f.style.left = Math.random() * 100 + "vw";
        f.style.fontSize = (24 + Math.random() * 22) + "px";
        f.style.opacity = 0.55 + Math.random() * 0.45;
        f.style.animationDuration = (5 + Math.random() * 6) + "s";
        document.body.appendChild(f);
    }

    /* SMALL ROUND WHITE DOT FLAKES */
    for (let i = 0; i < 70; i++) {
        let d = document.createElement("div");
        d.className = "smalldot";
        let size = 3 + Math.random() * 5;
        d.style.width = size + "px";
        d.style.height = size + "px";
        d.style.left = Math.random() * 100 + "vw";
        d.style.opacity = 0.3 + Math.random() * 0.5;
        d.style.animationDuration = (4 + Math.random() * 5) + "s";
        document.body.appendChild(d);
    }

    /* HEAVY GLITTER FLAKES (GLOWING SPARKLES) */
    for (let i = 0; i < 50; i++) {
        let g = document.createElement("div");
        g.className = "glitterflake";
        let size = 2 + Math.random() * 4;
        g.style.width = size + "px";
        g.style.height = size + "px";
        g.style.left = Math.random() * 100 + "vw";
        g.style.background = "rgba(255,255,255," + (0.5 + Math.random() * 0.5) + ")";
        g.style.animationDuration = (3 + Math.random() * 4) + "s";
        document.body.appendChild(g);
    }

});
</script>
"@

$html = $html -replace '</body>', "$snow`n</body>"

###############################################################
# 3. SAVE + OPEN
###############################################################

Set-Content $index $html -Encoding UTF8
Start-Process $index
