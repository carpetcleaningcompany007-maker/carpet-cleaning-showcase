<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>The Carpet Cleaning Company | Carpet and Upholstery Cleaning</title>
  <meta name="description" content="Professional carpet and upholstery cleaning with CRB agitation, hot water extraction and a 100 percent satisfaction guarantee." />

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: { 50:"#f5f3ff", 100:"#ede9fe", 600:"#7c3aed", 700:"#6d28d9", 900:"#3b1b8a" },
            ink: { 900:"#070b14", 800:"#0b1220", 700:"#0f172a" }
          },
          boxShadow: {
            soft:"0 12px 30px rgba(2,6,23,0.18)",
            card:"0 24px 70px rgba(2,6,23,0.38)"
          }
        }
      }
    }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

  <style>
    body { font-family: Inter, system-ui, -apple-system, "Segoe UI", sans-serif; }

    html, body { width: 100%; max-width: 100%; overflow-x: clip; }
    body { position: relative; }
    * { min-width: 0; }
    img, video, svg { max-width: 100%; height: auto; }
    :root { scroll-padding-top: 74px; }

    .glass { backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
    input, select, textarea { font-size: 16px; }

    .lift { transition: transform .18s ease, box-shadow .18s ease; }
    .lift:hover { transform: translateY(-2px); }

    .premium-field:focus {
      outline: none;
      box-shadow: 0 0 0 4px rgba(52,211,153,.25);
      border-color: rgba(16,185,129,.9);
    }

    .shimmer { position: relative; overflow: hidden; }
    .shimmer:after{
      content:"";
      position:absolute;
      inset:-40% -60%;
      transform: rotate(20deg);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.25), transparent);
      animation: shimmer 3.5s infinite;
      pointer-events:none;
    }
    @keyframes shimmer {
      0% { transform: translateX(-40%) rotate(20deg); opacity:0; }
      10% { opacity:1; }
      50% { transform: translateX(40%) rotate(20deg); opacity:0; }
      100% { opacity:0; }
    }

    @keyframes fadeUp {
      0% { opacity:0; transform: translateY(16px); }
      100% { opacity:1; transform: translateY(0); }
    }

    @keyframes popFloatIn {
      0%   { opacity:0; transform: scale(.78) translateY(10px); filter: blur(6px); }
      60%  { opacity:1; transform: scale(1.04) translateY(-2px); filter: blur(0); }
      100% { opacity:1; transform: scale(1) translateY(0); }
    }

    @keyframes floaty {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(-7px); }
    }

    @keyframes pulseRing {
      0%   { opacity:0; transform: scale(.85); }
      20%  { opacity:.9; }
      70%  { opacity:0; transform: scale(1.22); }
      100% { opacity:0; transform: scale(1.22); }
    }

    [data-anim] { opacity: 0; transform: translateY(14px); }
    .is-ready [data-anim="hero-title"] { animation: fadeUp 800ms ease-out forwards; }
    .is-ready [data-anim="hero-copy"]  { animation: fadeUp 820ms ease-out 120ms forwards; }
    .is-ready [data-anim="hero-points"]{ animation: fadeUp 860ms ease-out 180ms forwards; }
    .is-ready [data-anim="hero-cta"]   { animation: fadeUp 880ms ease-out 240ms forwards; }
    .is-ready [data-anim="hero-card"]  { animation: fadeUp 900ms ease-out 200ms forwards; }
    .in-view[data-anim="reveal"] { animation: fadeUp 750ms ease-out forwards; }

    .badge-wrap { position: relative; display: inline-grid; place-items: center; }
    .badge-wrap:before{
      content:"";
      position:absolute;
      width: 120%;
      height: 120%;
      border-radius: 999px;
      border: 2px solid rgba(16,185,129,.35);
      opacity: 0;
    }
    .is-ready .badge-wrap:before{ animation: pulseRing 1.7s ease-out .55s 1; }

    #satisfactionBadge { opacity: 0; transform: scale(.9) translateY(8px); }
    .is-ready #satisfactionBadge{
      opacity: 1;
      animation: popFloatIn 900ms cubic-bezier(.2,.8,.2,1) forwards, floaty 4.6s ease-in-out 1.1s infinite;
      transform-origin: 70% 30%;
    }

    #heroGlow { will-change: transform; transition: transform .15s ease-out; }

    .rev-card { transition: transform .2s ease, box-shadow .2s ease; }
    .rev-card:hover { transform: translateY(-6px); box-shadow: 0 34px 95px rgba(2,6,23,.18); }
    .clamp-3 {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .reveal-wrap {
      max-height: 0;
      opacity: 0;
      transform: translateY(-6px);
      overflow: hidden;
      transition: max-height .35s ease, opacity .25s ease, transform .25s ease;
    }
    .reveal-wrap.is-open { max-height: 560px; opacity: 1; transform: translateY(0); }

    /* Calculator visuals */
    .iq-pill { transition: transform .14s ease, box-shadow .14s ease; }
    .iq-pill:active { transform: scale(.98); }

    @keyframes bump {
      0% { transform: scale(.96); }
      100% { transform: scale(1); }
    }
    .bump { animation: bump 140ms ease-out; }

    @media (prefers-reduced-motion: reduce) {
      [data-anim], #satisfactionBadge { opacity: 1 !important; transform: none !important; animation: none !important; }
      .badge-wrap:before { display:none !important; }
      #heroGlow { transition: none !important; }
      .shimmer:after { animation: none !important; }
      .reveal-wrap { transition:none !important; max-height:none !important; opacity:1 !important; transform:none !important; }
      .bump { animation:none !important; }
    }
  </style>

  <script>
    (function () {
      try { if ("scrollRestoration" in history) history.scrollRestoration = "manual"; } catch (e) {}

      function clearHash() {
        if (location.hash) history.replaceState(null, "", location.pathname + location.search);
      }

      function hardTop() {
        clearHash();
        window.scrollTo(0, 0);
        requestAnimationFrame(() => window.scrollTo(0, 0));
        setTimeout(() => window.scrollTo(0, 0), 50);
        setTimeout(() => window.scrollTo(0, 0), 200);
      }

      hardTop();
      window.addEventListener("load", hardTop);
      window.addEventListener("pageshow", function (e) {
        if (e.persisted) hardTop();
        setTimeout(hardTop, 0);
      });

      document.addEventListener("click", function (e) {
        const a = e.target.closest('a[href^="#"]');
        if (!a) return;

        const id = a.getAttribute("href").slice(1);
        const target = document.getElementById(id);
        if (!target) return;

        e.preventDefault();
        target.scrollIntoView({ behavior: "smooth", block: "start" });
        setTimeout(clearHash, 10);
      }, { passive: false });
    })();
  </script>
</head>

<body class="bg-ink-900 text-slate-100 overflow-x-hidden">

  <div class="pointer-events-none fixed inset-0 z-[1] opacity-[0.06] mix-blend-overlay"
       style="background-image:url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22400%22%3E%3Cfilter id=%22n%22%3E%3CfeTurbulence type=%22fractalNoise%22 baseFrequency=%220.9%22 numOctaves=%222%22 stitchTiles=%22stitch%22/%3E%3C/filter%3E%3Crect width=%22400%22 height=%22400%22 filter=%22url(%23n)%22 opacity=%220.25%22/%3E%3C/svg%3E');">
  </div>

  <header class="fixed top-0 left-0 right-0 z-50 bg-emerald-900/90 glass border-b border-emerald-800/35">
    <div class="mx-auto max-w-6xl px-4 py-1.5 flex items-center justify-between gap-4">
      <div class="flex items-center gap-3 min-w-0">
        <img
          src="https://raw.githubusercontent.com/carpetcleaningcompany007-maker/carpet-cleaning-showcase/main/ChatGPT%20Image%20Feb%204,%202026,%2012_51_48%20AM.png"
          class="h-14 sm:h-20 w-auto object-contain shrink-0"
          alt="The Carpet Cleaning Company"
        />
        <div class="leading-tight min-w-0">
          <div class="font-extrabold text-base sm:text-lg truncate">The Carpet Cleaning Company</div>
          <div class="text-[11px] sm:text-xs text-emerald-100/90">Carpet and upholstery cleaning for homes and businesses</div>
        </div>
      </div>

      <div class="flex items-center gap-2">
        <a href="#instantCalculator"
           class="hidden sm:inline-flex items-center justify-center rounded-full bg-white/10 border border-white/15 hover:bg-white/15 px-4 py-2 text-sm font-semibold lift">
          Instant calculator
        </a>
        <a href="tel:07802563213"
           class="hidden sm:inline-flex items-center gap-2 rounded-full bg-white/10 border border-white/15 px-4 py-2 text-sm font-semibold lift">
          <span class="inline-block h-2 w-2 rounded-full bg-emerald-300"></span>
          07802 563213
        </a>
      </div>
    </div>
  </header>

  <section class="relative pt-24 md:pt-28 pb-14 md:pb-20 overflow-hidden overflow-x-clip isolate">
    <div class="absolute inset-0">
      <video
        id="heroVideo"
        class="absolute inset-0 w-full h-full object-cover opacity-70"
        autoplay
        muted
        loop
        playsinline
        webkit-playsinline
        preload="metadata"
        poster="static/hero.jpg"
      >
        <source src="istockphoto-2158195023-640_adpp_is.mp4" type="video/mp4" />
      </video>

      <div class="absolute inset-0 bg-gradient-to-b from-ink-900/40 via-ink-900/70 to-ink-900"></div>
      <div id="heroGlow" class="absolute inset-0 bg-[radial-gradient(1200px_700px_at_25%_20%,rgba(34,197,94,0.14),transparent_60%)]"></div>
    </div>

    <div class="relative mx-auto max-w-6xl px-4">
      <div class="grid lg:grid-cols-2 gap-10 items-start">
        <div class="pt-2">
          <h1 data-anim="hero-title" class="mt-4 text-4xl md:text-5xl font-extrabold leading-tight">
            Carpet and Upholstery Cleaning
            <span class="block text-slate-200 mt-2">Beautiful carpets. Instant calculator. Guaranteed results.</span>
          </h1>

          <p data-anim="hero-copy" class="mt-4 text-base md:text-lg text-slate-200 max-w-xl">
            CRB agitation lifts embedded soil, then hot water extraction with a neutralising rinse for soft, residue free fibres.
          </p>

          <div data-anim="hero-points" class="mt-5 space-y-2 text-sm text-slate-200">
            <div class="flex items-start gap-3">
              <span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-400 text-emerald-950 font-extrabold">âœ“</span>
              <span>CRB agitation lifts embedded soil</span>
            </div>
            <div class="flex items-start gap-3">
              <span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-400 text-emerald-950 font-extrabold">âœ“</span>
              <span>Steam cleaning up to 120 degrees for the best results</span>
            </div>
            <div class="flex items-start gap-3">
              <span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-400 text-emerald-950 font-extrabold">âœ“</span>
              <span>Fully insured for your peace of mind</span>
            </div>
            <div class="flex items-start gap-3">
              <span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full bg-emerald-400 text-emerald-950 font-extrabold">âœ“</span>
              <span>Wool and synthetic safe process</span>
            </div>
          </div>

          <div data-anim="hero-cta" class="mt-6 flex flex-wrap gap-3">
            <a href="#instantCalculator" class="inline-flex items-center justify-center rounded-full bg-emerald-400 hover:bg-emerald-300 text-emerald-950 px-6 py-3 text-sm font-extrabold shadow-soft lift shimmer">
              Instant calculator
            </a>
            <a href="#heroQuoteForm" class="inline-flex items-center justify-center rounded-full bg-white/10 border border-white/15 hover:bg-white/15 px-6 py-3 text-sm font-semibold lift">
              Request call back
            </a>
            <a href="#reviews" class="inline-flex items-center justify-center rounded-full bg-white/10 border border-white/15 hover:bg-white/15 px-6 py-3 text-sm font-semibold lift">
              Read reviews first
            </a>
          </div>

          <div class="mt-6 inline-flex items-center gap-3 rounded-full bg-white/10 border border-white/15 px-4 py-2 lift">
            <span class="inline-flex items-center justify-center h-8 w-8 rounded-full bg-emerald-400 text-emerald-950 text-sm font-extrabold">âœ“</span>
            <span class="text-sm font-semibold">100 percent satisfaction guarantee</span>
          </div>
        </div>

        <div class="lg:pt-2">
          <div data-anim="hero-card" class="relative rounded-3xl bg-white text-slate-900 shadow-card border border-white/40 overflow-hidden lift max-w-full">
            <div class="absolute inset-x-0 top-0 h-24 bg-gradient-to-r from-emerald-50 via-white to-emerald-50"></div>
            <div class="absolute -top-24 -right-24 h-64 w-64 rounded-full bg-emerald-200 blur-3xl opacity-70"></div>

            <div class="relative p-6 md:p-7">
              <div class="flex items-start justify-between gap-4">
                <div class="min-w-0">
                  <div class="text-xl font-extrabold">Call Back Request</div>
                  <p class="mt-1 text-sm text-slate-600">Use the calculator first, then send your details</p>
                </div>

                <span class="badge-wrap shrink-0">
                  <img
                    id="satisfactionBadge"
                    src="https://raw.githubusercontent.com/carpetcleaningcompany007-maker/carpet-cleaning-showcase/main/satisfaction_badge_transparent.png"
                    alt="100% Satisfaction Guaranteed"
                    class="h-24 w-24 sm:h-36 sm:w-36 object-contain drop-shadow-xl"
                  />
                </span>
              </div>

              <form
                id="heroQuoteForm"
                class="mt-5"
                action="https://formspree.io/f/mblnzwpv"
                method="POST"
                onsubmit="submitQuote(event, this);"
              >
                <input type="hidden" name="_subject" value="New Quote Request - The Carpet Cleaning Company" />
                <input type="hidden" name="_format" value="plain" />

                <!-- Calculator payload -->
                <input type="hidden" name="instant_calculator_total" id="instant_calculator_total" value="Â£0.00" />
                <input type="hidden" name="instant_calculator_items" id="instant_calculator_items" value="" />

                <div class="space-y-4">
                  <div class="rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-3 shadow-soft">
                    <div class="text-xs font-semibold text-emerald-800 uppercase">Selected total</div>
                    <div class="mt-1 text-3xl font-extrabold text-emerald-950" id="miniTotal">Â£0.00</div>
                    <div class="mt-2 text-[11px] text-emerald-900/80">
                      This updates from the calculator. If nothing is selected, use the calculator first.
                    </div>
                    <div class="mt-3 flex flex-wrap gap-2">
                      <a href="#instantCalculator"
                         class="inline-flex items-center justify-center rounded-full bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 text-xs font-extrabold lift shimmer">
                        Open calculator
                      </a>
                      <button type="button" id="miniCopy"
                         class="inline-flex items-center justify-center rounded-full bg-white border border-emerald-200 hover:bg-emerald-100 px-4 py-2 text-xs font-extrabold lift">
                        Copy items
                      </button>
                    </div>
                  </div>

                  <div class="grid sm:grid-cols-2 gap-4">
                    <label class="block">
                      <span class="text-sm font-semibold text-slate-700">Postcode <span class="text-rose-500">*</span></span>
                      <input required name="postcode" autocomplete="postal-code"
                        class="premium-field mt-1 w-full rounded-xl border border-slate-300 px-3 py-2.5 text-sm"
                        placeholder="e.g. SY8 1AA" />
                    </label>

                    <label class="block">
                      <span class="text-sm font-semibold text-slate-700">Preferred timing</span>
                      <select name="timing"
                        class="premium-field mt-1 w-full rounded-xl border border-slate-300 px-3 py-2.5 text-sm bg-white">
                        <option>As soon as possible</option>
                        <option>This week</option>
                        <option>Next week</option>
                        <option>Just pricing</option>
                      </select>
                    </label>
                  </div>

                  <label class="block">
                    <span class="text-sm font-semibold text-slate-700">Full name <span class="text-rose-500">*</span></span>
                    <input required name="name" autocomplete="name"
                      class="premium-field mt-1 w-full rounded-xl border border-slate-300 px-3 py-2.5 text-sm"
                      placeholder="Your name" />
                  </label>

                  <div class="grid sm:grid-cols-2 gap-4">
                    <label class="block">
                      <span class="text-sm font-semibold text-slate-700">Phone <span class="text-rose-500">*</span></span>
                      <input required id="phoneField" name="phone" inputmode="tel" autocomplete="tel"
                        class="premium-field mt-1 w-full rounded-xl border border-slate-300 px-3 py-2.5 text-sm"
                        placeholder="07..." />
                    </label>

                    <label class="block">
                      <span class="text-sm font-semibold text-slate-700">Email <span class="text-rose-500">*</span></span>
                      <input required id="emailField" name="email" type="email" autocomplete="email"
                        class="premium-field mt-1 w-full rounded-xl border border-slate-300 px-3 py-2.5 text-sm"
                        placeholder="you@example.com" />
                    </label>
                  </div>

                  <div id="extraFields" class="reveal-wrap">
                    <div class="rounded-2xl border border-emerald-200 bg-emerald-50 px-4 py-4 shadow-soft">
                      <div class="text-sm font-extrabold text-emerald-950">Anything we should know</div>
                      <div class="text-xs text-emerald-900/80 mt-1">Stains, pets, parking, access, ideal days</div>

                      <textarea name="notes" rows="3"
                        class="premium-field mt-3 w-full rounded-xl border border-emerald-200 bg-white px-3 py-2.5 text-sm"
                        placeholder="Type here..."></textarea>

                      <div class="mt-4 rounded-xl border border-emerald-200 bg-white px-4 py-3">
                        <div class="text-sm font-extrabold text-slate-900">Buy now pay later with Klarna</div>
                        <div class="text-xs text-slate-600 mt-1">We can offer Klarna so you can spread the cost over 3 months. Interested?</div>

                        <div class="mt-3 flex flex-wrap gap-3">
                          <label class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-2 text-xs font-bold text-slate-700">
                            <input type="radio" name="klarna_interest" value="Yes" class="h-4 w-4" />
                            Yes
                          </label>
                          <label class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-slate-50 px-3 py-2 text-xs font-bold text-slate-700">
                            <input type="radio" name="klarna_interest" value="No" class="h-4 w-4" />
                            No
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <button id="submitBtn" type="submit"
                    class="w-full rounded-2xl bg-emerald-400 hover:bg-emerald-300 text-emerald-950 px-4 py-3.5 text-sm font-extrabold shadow-soft lift shimmer">
                    Request call back
                  </button>

                  <p class="text-xs text-slate-500 text-center">We will contact you from 07802 563213. No obligation.</p>
                </div>
              </form>

            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- INSTANT CALCULATOR (separate from form, no item prices shown) -->
  <section id="instantCalculator" class="py-14 bg-white text-slate-900">
    <div class="mx-auto max-w-6xl px-4">
      <div class="relative overflow-hidden rounded-3xl border border-slate-200 shadow-soft bg-gradient-to-br from-slate-50 via-white to-emerald-50">
        <div class="absolute -top-28 -right-28 h-64 w-64 rounded-full bg-emerald-200 blur-3xl opacity-70"></div>

        <div class="relative p-6 md:p-8">
          <div class="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6">
            <div class="min-w-0">
              <div class="inline-flex items-center gap-2 rounded-full bg-white border border-emerald-200 px-3 py-1 text-xs font-semibold text-emerald-800 lift">
                Instant Price Calculator
              </div>
              <h2 class="mt-3 text-3xl font-extrabold">Tap your rooms and add ons</h2>
              <p class="mt-2 text-sm md:text-base text-slate-600 max-w-2xl">
                You will not see per item pricing here. Your total updates instantly and your selected items carry into the call back request.
              </p>

              <div class="mt-4 flex flex-wrap gap-2">
                <span class="inline-flex items-center gap-2 rounded-full bg-white border border-slate-200 px-3 py-1 text-[11px] font-semibold text-slate-700">
                  <span class="inline-block h-2 w-2 rounded-full bg-emerald-500"></span>
                  No hidden extras
                </span>
                <span class="inline-flex items-center gap-2 rounded-full bg-white border border-slate-200 px-3 py-1 text-[11px] font-semibold text-slate-700">
                  <span class="inline-block h-2 w-2 rounded-full bg-emerald-500"></span>
                  Fast booking
                </span>
                <span class="inline-flex items-center gap-2 rounded-full bg-white border border-slate-200 px-3 py-1 text-[11px] font-semibold text-slate-700">
                  <span class="inline-block h-2 w-2 rounded-full bg-emerald-500"></span>
                  100 percent satisfaction guarantee
                </span>
              </div>
            </div>

            <div class="w-full lg:w-[420px]">
              <div class="rounded-3xl border border-emerald-200 bg-emerald-50 p-5 shadow-soft">
                <div class="text-xs font-semibold text-emerald-800 uppercase">Estimated total</div>
                <div class="mt-1 text-5xl font-extrabold text-emerald-700" id="iqTotal">Â£0.00</div>
                <div class="mt-2 text-[11px] text-emerald-900/80">Final price confirmed on booking. No obligation.</div>

                <div class="mt-4 flex flex-wrap gap-2">
                  <button type="button" id="iqReset"
                    class="inline-flex items-center justify-center rounded-full bg-white border border-emerald-200 hover:bg-emerald-100 px-4 py-2 text-xs font-extrabold lift">
                    Reset
                  </button>
                  <button type="button" id="iqCopy"
                    class="inline-flex items-center justify-center rounded-full bg-slate-900 hover:bg-slate-800 text-white px-4 py-2 text-xs font-extrabold lift">
                    Copy selection
                  </button>
                  <a href="#heroQuoteForm"
                    class="inline-flex items-center justify-center rounded-full bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 text-xs font-extrabold lift shimmer">
                    Request call back
                  </a>
                </div>

                <div class="mt-4 rounded-2xl border border-emerald-200 bg-white p-4">
                  <div class="text-xs font-extrabold text-slate-900">Selected items</div>
                  <div class="text-[11px] text-slate-600 mt-1">This will be sent with your enquiry</div>
                  <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
                    <pre id="iqSummary" class="whitespace-pre-wrap text-[12px] leading-5 text-slate-800">No items selected yet.</pre>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <!-- Tabs -->
          <div class="mt-8 flex flex-wrap gap-2">
            <button type="button" class="iqTab rounded-full px-4 py-2 text-xs font-extrabold border lift bg-slate-900 text-white border-slate-900" data-tab="carpets">
              Carpets and rugs
            </button>
            <button type="button" class="iqTab rounded-full px-4 py-2 text-xs font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50" data-tab="upholstery">
              Sofas and upholstery
            </button>
            <button type="button" class="iqTab rounded-full px-4 py-2 text-xs font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50" data-tab="addons">
              Optional add ons
            </button>
          </div>

          <!-- Panels -->
          <div class="mt-4">
            <!-- Carpets -->
            <div class="iqPanel" data-panel="carpets">
              <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4" id="iqCarpets"></div>
            </div>

            <!-- Upholstery -->
            <div class="iqPanel hidden" data-panel="upholstery">
              <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4" id="iqUpholstery"></div>
            </div>

            <!-- Add ons -->
            <div class="iqPanel hidden" data-panel="addons">
              <div class="rounded-3xl border border-slate-200 bg-white shadow-soft p-6">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                  <div>
                    <div class="text-xl font-extrabold">Optional add ons</div>
                    <div class="text-sm text-slate-600 mt-1">Enable these, then apply them to any selected item</div>
                  </div>

                  <div class="flex flex-wrap gap-2">
                    <button type="button" class="iqAddonMaster iq-pill rounded-full px-4 py-2 text-xs font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50" data-addon="scotchgard">
                      Stain guard
                    </button>
                    <button type="button" class="iqAddonMaster iq-pill rounded-full px-4 py-2 text-xs font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50" data-addon="deodorise">
                      Deodorise
                    </button>
                    <button type="button" class="iqAddonMaster iq-pill rounded-full px-4 py-2 text-xs font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50" data-addon="insecticide">
                      Insecticide
                    </button>
                  </div>
                </div>

                <div class="mt-6 grid md:grid-cols-3 gap-4">
                  <div class="rounded-2xl border border-emerald-200 bg-emerald-50 p-5">
                    <div class="text-sm font-extrabold text-emerald-950">Stain guard</div>
                    <div class="text-xs text-emerald-900/80 mt-1">Adds protection to help resist future staining and makes maintenance easier.</div>
                  </div>
                  <div class="rounded-2xl border border-emerald-200 bg-emerald-50 p-5">
                    <div class="text-sm font-extrabold text-emerald-950">Deodorise</div>
                    <div class="text-xs text-emerald-900/80 mt-1">Neutralises odours at fibre level for a fresher finish.</div>
                  </div>
                  <div class="rounded-2xl border border-emerald-200 bg-emerald-50 p-5">
                    <div class="text-sm font-extrabold text-emerald-950">Insecticide</div>
                    <div class="text-xs text-emerald-900/80 mt-1">For textile insect pests where required as part of a professional treatment.</div>
                  </div>
                </div>

                <div class="mt-6 rounded-2xl border border-slate-200 bg-slate-50 p-5">
                  <div class="text-sm font-extrabold text-slate-900">Apply add ons to selected items</div>
                  <div class="text-xs text-slate-600 mt-1">Go back to carpets or upholstery and toggle add ons per item</div>
                </div>
              </div>
            </div>
          </div>

          <div class="mt-8 rounded-3xl border border-slate-200 bg-slate-900 text-white p-6 shadow-soft">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
              <div>
                <div class="text-xl font-extrabold">Ready to book</div>
                <div class="text-sm text-white/80 mt-1">Send your details and we will confirm a fixed price and next available dates</div>
              </div>
              <div class="flex flex-wrap gap-2">
                <a href="#heroQuoteForm" class="rounded-full bg-emerald-400 hover:bg-emerald-300 text-emerald-950 px-6 py-3 text-sm font-extrabold shadow-soft lift shimmer">
                  Request call back
                </a>
                <a href="tel:07802563213" class="rounded-full bg-white/10 border border-white/15 hover:bg-white/15 px-6 py-3 text-sm font-semibold lift">
                  Call 07802 563213
                </a>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>
  </section>

  <section class="py-14 bg-white text-slate-900">
    <div class="mx-auto max-w-6xl px-4">
      <h2 data-anim="reveal" class="text-3xl font-extrabold">How the clean works</h2>
      <p data-anim="reveal" class="mt-2 text-sm md:text-base text-slate-600 max-w-xl">
        A simple method used in homes and workplaces so you know what to expect on the day.
      </p>

      <div data-anim="reveal" class="mt-5 rounded-2xl border border-emerald-200 bg-emerald-50 px-5 py-4 shadow-soft lift">
        <div class="text-xs font-semibold text-emerald-700 uppercase">Best results</div>
        <div class="mt-1 text-lg font-extrabold text-emerald-950">Steam cleaning up to 120 degrees</div>
        <div class="mt-1 text-sm text-emerald-900/80">High heat helps break down grease, lift deep soil and leave fibres fresh and residue free.</div>
      </div>

      <div class="mt-8 grid md:grid-cols-3 gap-6">
        <div data-anim="reveal" class="bg-slate-50 rounded-2xl border border-slate-200 shadow-soft p-6 lift">
          <div class="text-xs font-semibold text-emerald-700 uppercase">Step one</div>
          <div class="mt-1 text-lg font-semibold">Survey and vacuum</div>
          <p class="mt-2 text-sm text-slate-600">
            Quick walk through, fibre check and a full dry vacuum to remove loose soil before any solution is applied.
          </p>
        </div>

        <div data-anim="reveal" class="bg-slate-50 rounded-2xl border border-slate-200 shadow-soft p-6 lift">
          <div class="text-xs font-semibold text-emerald-700 uppercase">Step two</div>
          <div class="mt-1 text-lg font-semibold">Pre spray and CRB agitation</div>
          <p class="mt-2 text-sm text-slate-600">
            A fibre safe solution is chosen then worked into the pile with a counter rotating brush to lift and release soil.
          </p>
        </div>

        <div data-anim="reveal" class="bg-slate-50 rounded-2xl border border-slate-200 shadow-soft p-6 lift">
          <div class="text-xs font-semibold text-emerald-700 uppercase">Step three</div>
          <div class="mt-1 text-lg font-semibold">120 degree steam rinse and finish</div>
          <p class="mt-2 text-sm text-slate-600">
            High heat extraction with a neutralising rinse removes residues so carpets dry clean and soft.
          </p>
        </div>
      </div>
    </div>
  </section>

  <section id="videos" class="py-14 bg-white text-slate-900">
    <div class="mx-auto max-w-6xl px-4">
      <h2 data-anim="reveal" class="text-3xl font-extrabold">Watch the results</h2>
      <p data-anim="reveal" class="mt-2 text-slate-600">A recent clean in action.</p>

      <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 justify-items-center">
        <div data-anim="reveal" class="w-[267px] h-[476px] overflow-hidden rounded-2xl border border-slate-200 shadow-soft bg-black lift">
          <iframe
            src="https://www.facebook.com/plugins/video.php?href=https%3A%2F%2Fwww.facebook.com%2F61559013150413%2Fvideos%2F1899520797292791%2F&show_text=false"
            width="267" height="476" style="border:none;overflow:hidden" scrolling="no" frameborder="0"
            allowfullscreen="true"
            allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"
          ></iframe>
        </div>

        <div data-anim="reveal" class="w-[267px] h-[476px] overflow-hidden rounded-2xl border border-slate-200 shadow-soft bg-black lift">
          <iframe
            src="https://www.facebook.com/plugins/video.php?href=https%3A%2F%2Fwww.facebook.com%2F61559013150413%2Fvideos%2F1162016885802464%2F&show_text=false"
            width="267" height="476" style="border:none;overflow:hidden" scrolling="no" frameborder="0"
            allowfullscreen="true"
            allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"
          ></iframe>
        </div>

        <div data-anim="reveal" class="w-[267px] h-[476px] overflow-hidden rounded-2xl border border-slate-200 shadow-soft bg-black lift">
          <iframe
            src="https://www.facebook.com/plugins/video.php?href=https%3A%2F%2Fwww.facebook.com%2F61559013150413%2Fvideos%2F1362198414861523%2F&show_text=false"
            width="267" height="476" style="border:none;overflow:hidden" scrolling="no" frameborder="0"
            allowfullscreen="true"
            allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"
          ></iframe>
        </div>
      </div>
    </div>
  </section>

  <section id="reviews" class="py-14 bg-emerald-50 text-slate-900">
    <div class="mx-auto max-w-6xl px-4">
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-6">
        <div>
          <div data-anim="reveal" class="inline-flex items-center gap-2 rounded-full bg-white border border-emerald-200 px-3 py-1 text-xs font-semibold text-emerald-800 lift">
            Google Reviews
          </div>
          <h2 data-anim="reveal" class="mt-3 text-3xl font-extrabold">Look at our amazing 5 star Google reviews</h2>
          <p data-anim="reveal" class="mt-2 text-sm md:text-base text-slate-700 max-w-2xl">
            We are proud of our genuine Google reviews. You can read the full review from each customer below.
          </p>
        </div>

        <div data-anim="reveal" class="rounded-3xl border border-emerald-200 bg-white px-5 py-4 shadow-soft w-full md:w-auto lift">
          <div class="flex items-center gap-3">
            <div class="text-3xl font-extrabold">5.0</div>
            <div>
              <div class="text-amber-500 text-sm leading-none">â˜…â˜…â˜…â˜…â˜…</div>
              <div class="text-xs text-slate-500 mt-1">30 plus Google reviews</div>
            </div>
          </div>

          <div class="mt-3 flex flex-wrap gap-2">
            <a href="#instantCalculator"
              class="inline-flex items-center justify-center rounded-full bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 text-xs font-extrabold lift shimmer">
              Instant calculator
            </a>
            <button type="button" id="expandAllBtn"
              class="inline-flex items-center justify-center rounded-full bg-white border border-slate-200 hover:bg-slate-50 px-4 py-2 text-xs font-bold lift">
              Expand all
            </button>
            <button type="button" id="collapseAllBtn"
              class="inline-flex items-center justify-center rounded-full bg-white border border-slate-200 hover:bg-slate-50 px-4 py-2 text-xs font-bold lift">
              Collapse all
            </button>
          </div>
        </div>
      </div>

      <div class="mt-8 grid md:grid-cols-2 xl:grid-cols-3 gap-6" id="reviewsGrid"></div>

      <div class="mt-8 flex flex-col sm:flex-row gap-3">
        <button type="button" id="loadMoreBtn"
          class="inline-flex items-center justify-center rounded-full bg-slate-900 hover:bg-slate-800 text-white px-6 py-3 text-sm font-extrabold lift">
          Load 10 more reviews
        </button>

        <a href="#instantCalculator"
          class="inline-flex items-center justify-center rounded-full bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-3 text-sm font-extrabold lift shimmer">
          Get my quote
        </a>
      </div>

      <p class="mt-4 text-xs text-slate-600">
        Reviews shown are copied from Google review text provided by the business and may include shortened display names exactly as shown on Google.
      </p>
    </div>
  </section>

  <section id="guarantee" class="py-12 bg-white text-slate-900">
    <div class="mx-auto max-w-6xl px-4 grid md:grid-cols-3 gap-8 items-center">
      <div class="md:col-span-2">
        <h2 data-anim="reveal" class="text-2xl font-extrabold">100 percent satisfaction guarantee</h2>
        <p data-anim="reveal" class="mt-2 text-sm md:text-base text-slate-700 max-w-2xl">
          If you are not happy with the result in any area, it will be returned and cleaned again. If it still does not look as it should, the cost of that area will be refunded.
        </p>
      </div>

      <div class="flex md:justify-end">
        <div data-anim="reveal" class="rounded-3xl bg-emerald-50 border border-emerald-200 shadow-soft px-6 py-6 text-center w-full md:w-auto lift">
          <div class="text-xs font-semibold text-slate-500 uppercase">Satisfaction promise</div>
          <div class="text-4xl font-extrabold text-emerald-700 mt-1">100%</div>
          <div class="text-xs text-slate-500 mt-1">Simple and written in plain English</div>
        </div>
      </div>
    </div>
  </section>

  <section id="quote" class="py-14 bg-ink-900">
    <div class="mx-auto max-w-6xl px-4">
      <div data-anim="reveal" class="rounded-3xl bg-white/5 border border-white/10 p-6 md:p-8 lift">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
          <div>
            <h2 class="text-2xl md:text-3xl font-extrabold">Want a fixed price quote</h2>
            <p class="mt-1 text-slate-200 text-sm md:text-base">Use the instant calculator and request a call back at the top.</p>
          </div>
          <div class="flex gap-3 flex-wrap">
            <a href="#instantCalculator"
              class="rounded-full bg-emerald-400 hover:bg-emerald-300 text-emerald-950 px-6 py-3 text-sm font-extrabold shadow-soft lift shimmer">
              Instant calculator
            </a>
            <a href="tel:07802563213"
              class="rounded-full bg-white/10 border border-white/15 hover:bg-white/15 px-6 py-3 text-sm font-semibold lift">
              Call 07802 563213
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="py-10 bg-ink-900 border-t border-white/10">
    <div class="mx-auto max-w-6xl px-4 flex flex-col md:flex-row items-center justify-between gap-3 text-sm">
      <div class="text-slate-200">
        <div class="font-semibold">The Carpet Cleaning Company</div>
        <div class="text-xs text-slate-400">Carpet and upholstery cleaning in Ludlow, Shropshire and nearby areas</div>
      </div>
      <div class="text-xs text-slate-500">
        Â© <span id="year">2025</span> The Carpet Cleaning Company. All rights reserved.
      </div>
    </div>
  </footer>

  <div class="fixed z-[90] flex flex-col gap-3"
       style="right: max(1rem, env(safe-area-inset-right)); bottom: max(1rem, env(safe-area-inset-bottom)); max-width: 100vw;">
    <a
      href="https://wa.me/447802563213?text=Hi%20Paul%2C%20I%E2%80%99d%20like%20a%20quote%20please.%0AMy%20postcode%3A%20____%0AWhat%20needs%20cleaning%3A%20____"
      target="_blank"
      rel="noopener"
      class="h-14 w-14 rounded-full shadow-card bg-[#25D366] grid place-items-center text-white text-2xl lift"
      aria-label="WhatsApp"
    >ðŸ’¬</a>

    <a
      href="tel:07802563213"
      class="h-14 w-14 rounded-full shadow-card bg-emerald-400 grid place-items-center text-emerald-950 text-2xl lift"
      aria-label="Call"
    >â˜Ž</a>
  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
    window.addEventListener("load", () => document.documentElement.classList.add("is-ready"));

    (function () {
      const els = Array.from(document.querySelectorAll('[data-anim="reveal"]'));
      if (!els.length) return;

      const io = new IntersectionObserver((entries) => {
        entries.forEach((e) => {
          if (e.isIntersecting) {
            e.target.classList.add("in-view");
            io.unobserve(e.target);
          }
        });
      }, { threshold: 0.14 });

      els.forEach(el => io.observe(el));
    })();

    (function () {
      const glow = document.getElementById("heroGlow");
      if (!glow) return;
      const isCoarse = window.matchMedia && window.matchMedia("(pointer: coarse)").matches;
      if (isCoarse) return;

      const maxX = 18, maxY = 12;
      window.addEventListener("mousemove", (e) => {
        const x = (e.clientX / window.innerWidth) - 0.5;
        const y = (e.clientY / window.innerHeight) - 0.5;
        glow.style.transform = `translate(${x * maxX}px, ${y * maxY}px)`;
      }, { passive: true });
    })();

    (function () {
      const v = document.getElementById("heroVideo");
      if (!v) return;
      const tryPlay = () => {
        const p = v.play();
        if (p && typeof p.catch === "function") p.catch(() => {});
      };
      tryPlay();
      window.addEventListener("touchstart", tryPlay, { once: true, passive: true });
      window.addEventListener("click", tryPlay, { once: true, passive: true });
    })();

    (function () {
      const phone = document.getElementById("phoneField");
      const email = document.getElementById("emailField");
      const wrap  = document.getElementById("extraFields");
      if (!phone || !email || !wrap) return;

      function shouldOpen() {
        const phoneOk = phone.value.trim().length >= 8;
        const emailOk = email.value.trim().length > 0 && email.checkValidity();
        return phoneOk && emailOk;
      }

      function sync() { wrap.classList.toggle("is-open", shouldOpen()); }

      ["input","blur","change"].forEach(evt => {
        phone.addEventListener(evt, sync, { passive: true });
        email.addEventListener(evt, sync, { passive: true });
      });

      sync();
    })();

    async function submitQuote(e, form) {
      e.preventDefault();

      const btn = document.getElementById("submitBtn");
      if (btn) { btn.disabled = true; btn.textContent = "Sending..."; }

      try {
        const res = await fetch(form.action, {
          method: "POST",
          body: new FormData(form),
          headers: { "Accept": "application/json" }
        });

        if (!res.ok) throw new Error("Formspree submit failed");

        alert("Thank you. Your request has been received.");
        form.reset();

        const wrap = document.getElementById("extraFields");
        if (wrap) wrap.classList.remove("is-open");
      } catch (err) {
        alert("Sorry, it didnâ€™t send. Please try again, or call 07802 563213.");
      } finally {
        if (btn) { btn.disabled = false; btn.textContent = "Request call back"; }
      }
    }

    /* =========================
       INSTANT CALCULATOR LOGIC
       No item prices shown, totals only.
       Change internal prices below to match your real rates.
       ========================= */
    (function () {
      const STORAGE_KEY = "tccc_calc_v2";

      const PRICES = {
        carpets: [
          { id:"hallway",      title:"Hallway",     subtitle:"Downstairs corridor", price:45 },
          { id:"landing",      title:"Landing",     subtitle:"Upstairs passage",    price:45 },
          { id:"bathroom",     title:"Bathroom",    subtitle:"or shower room",      price:45 },
          { id:"box_room",     title:"Box Room",    subtitle:"Box bedroom or study",price:30 },
          { id:"study",        title:"Study",       subtitle:"Office or study",     price:30 },
          { id:"staircase",    title:"Staircase",   subtitle:"Per flight",          price:45 },
          { id:"bedroom",      title:"Bedroom",     subtitle:"Regular or large",    price:45 },
          { id:"dining_room",  title:"Dining Room", subtitle:"or breakfast room",   price:75 },
          { id:"rugs",         title:"Rugs",        subtitle:"Steam clean",         price:35 },
          { id:"living_room",  title:"Living Room", subtitle:"Family room",         price:75 },
          { id:"lounge_diner", title:"Lounge Diner",subtitle:"Joined through room", price:90 }
        ],
        upholstery: [
          { id:"armchair",   title:"Armchair",    subtitle:"Single chair",           price:55 },
          { id:"2_seater",   title:"2 Seater",    subtitle:"Fabric or leather",      price:85 },
          { id:"3_seater",   title:"3 Seater",    subtitle:"Fabric or leather",      price:105 },
          { id:"corner",     title:"Corner Sofa", subtitle:"Typical L shape",        price:145 },
          { id:"footstool",  title:"Footstool",   subtitle:"Small item",             price:25 },
          { id:"dining_ch",  title:"Dining Chair",subtitle:"Per chair",              price:15 }
        ]
      };

      const ADDON_PRICES = {
        scotchgard: 30,
        deodorise:  15,
        insecticide:25
      };

      const els = {
        iqTotal: document.getElementById("iqTotal"),
        iqSummary: document.getElementById("iqSummary"),
        iqReset: document.getElementById("iqReset"),
        iqCopy: document.getElementById("iqCopy"),
        tabs: Array.from(document.querySelectorAll(".iqTab")),
        panels: Array.from(document.querySelectorAll(".iqPanel")),
        carpetsGrid: document.getElementById("iqCarpets"),
        upholsteryGrid: document.getElementById("iqUpholstery"),
        addonMasters: Array.from(document.querySelectorAll(".iqAddonMaster")),

        miniTotal: document.getElementById("miniTotal"),
        miniCopy: document.getElementById("miniCopy"),

        hiddenTotal: document.getElementById("instant_calculator_total"),
        hiddenItems: document.getElementById("instant_calculator_items")
      };

      if (!els.iqTotal || !els.iqSummary || !els.carpetsGrid || !els.upholsteryGrid) return;

      const state = {
        tab: "carpets",
        items: {},     // id -> { qty, addons: {scotchgard,deodorise,insecticide} }
        addonOn: { scotchgard:false, deodorise:false, insecticide:false } // master toggles
      };

      const fmt = (n) => "Â£" + (Math.round((Number(n)||0) * 100) / 100).toFixed(2);

      function load() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return;
          const data = JSON.parse(raw);
          if (!data || typeof data !== "object") return;
          if (data.tab) state.tab = data.tab;
          if (data.items) state.items = data.items;
          if (data.addonOn) state.addonOn = data.addonOn;
        } catch (e) {}
      }

      function save() {
        try { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); } catch (e) {}
      }

      function getItem(id) {
        if (!state.items[id]) {
          state.items[id] = { qty: 0, addons: { scotchgard:false, deodorise:false, insecticide:false } };
        }
        return state.items[id];
      }

      function allCatalog() {
        return [...PRICES.carpets, ...PRICES.upholstery];
      }

      function calcLine(catalogItem, itemState) {
        const q = Math.max(0, Math.min(99, Number(itemState.qty)||0));
        if (!q) return 0;
        let t = catalogItem.price * q;
        if (itemState.addons.scotchgard)  t += ADDON_PRICES.scotchgard * q;
        if (itemState.addons.deodorise)   t += ADDON_PRICES.deodorise * q;
        if (itemState.addons.insecticide) t += ADDON_PRICES.insecticide * q;
        return t;
      }

      function calcTotal() {
        const cat = allCatalog();
        let total = 0;
        for (const c of cat) {
          const it = getItem(c.id);
          total += calcLine(c, it);
        }
        return total;
      }

      function niceAddonLabel(key) {
        if (key === "scotchgard") return "Stain guard";
        if (key === "deodorise") return "Deodorise";
        if (key === "insecticide") return "Insecticide";
        return key;
      }

      function buildSummary() {
        const lines = [];
        const cat = allCatalog();

        for (const c of cat) {
          const it = getItem(c.id);
          const q = Math.max(0, Math.min(99, Number(it.qty)||0));
          if (!q) continue;

          const add = [];
          Object.keys(it.addons || {}).forEach(k => { if (it.addons[k]) add.push(niceAddonLabel(k)); });

          lines.push(`${q} x ${c.title}`);
          if (add.length) lines.push(`  Add ons: ${add.join(", ")}`);
          lines.push("");
        }

        if (!lines.length) return "No items selected yet.";
        lines.push(`Estimated total: ${fmt(calcTotal())}`);
        return lines.join("\n").trim();
      }

      function syncOutputs(pop) {
        const total = calcTotal();
        const summary = buildSummary();

        els.iqTotal.textContent = fmt(total);
        els.iqSummary.textContent = summary;

        if (els.miniTotal) els.miniTotal.textContent = fmt(total);

        if (els.hiddenTotal) els.hiddenTotal.value = fmt(total);
        if (els.hiddenItems) els.hiddenItems.value = summary;

        if (pop) {
          els.iqTotal.classList.remove("bump");
          void els.iqTotal.offsetWidth;
          els.iqTotal.classList.add("bump");
        }

        save();
      }

      function tabClass(active) {
        return active
          ? "iqTab rounded-full px-4 py-2 text-xs font-extrabold border lift bg-slate-900 text-white border-slate-900"
          : "iqTab rounded-full px-4 py-2 text-xs font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50";
      }

      function setTab(tab) {
        state.tab = tab;

        els.tabs.forEach(b => {
          const t = b.getAttribute("data-tab");
          b.className = tabClass(t === tab);
        });

        els.panels.forEach(p => {
          const name = p.getAttribute("data-panel");
          p.classList.toggle("hidden", name !== tab);
        });

        save();
      }

      function addonMasterClass(active) {
        return active
          ? "iqAddonMaster iq-pill rounded-full px-4 py-2 text-xs font-extrabold border lift bg-emerald-600 text-white border-emerald-600"
          : "iqAddonMaster iq-pill rounded-full px-4 py-2 text-xs font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50";
      }

      function addonChipClass(active) {
        return active
          ? "iqAddon iq-pill rounded-full px-3 py-1.5 text-[11px] font-extrabold border lift bg-emerald-600 text-white border-emerald-600"
          : "iqAddon iq-pill rounded-full px-3 py-1.5 text-[11px] font-extrabold border lift bg-white text-slate-900 border-slate-200 hover:bg-slate-50";
      }

      function cardHtml(c) {
        const it = getItem(c.id);
        const q = Math.max(0, Math.min(99, Number(it.qty)||0));

        const a = it.addons || { scotchgard:false, deodorise:false, insecticide:false };

        return `
          <div class="rounded-3xl border border-slate-200 bg-white shadow-soft p-5 lift">
            <div class="flex items-start justify-between gap-3">
              <div class="min-w-0">
                <div class="text-lg font-extrabold text-slate-900">${c.title}</div>
                <div class="text-xs text-slate-600 mt-0.5">${c.subtitle || ""}</div>
              </div>
              <div class="shrink-0">
                <div class="inline-flex items-center justify-center h-10 w-10 rounded-2xl bg-slate-900 text-white font-extrabold" data-qty="${c.id}">${q}</div>
              </div>
            </div>

            <div class="mt-4 flex items-center justify-between gap-3">
              <div class="flex items-center gap-2">
                <button type="button" class="iqMinus h-11 w-11 rounded-full bg-slate-900 text-white text-lg font-extrabold lift" data-id="${c.id}" aria-label="Decrease">âˆ’</button>
                <button type="button" class="iqPlus h-11 w-11 rounded-full bg-emerald-600 text-white text-lg font-extrabold lift" data-id="${c.id}" aria-label="Increase">+</button>
              </div>

              <div class="text-right">
                <div class="text-[11px] text-slate-500">Included in total</div>
                <div class="text-sm font-extrabold text-emerald-700">Instant updates</div>
              </div>
            </div>

            <div class="mt-4 flex flex-wrap gap-2">
              <button type="button" class="iqAddon ${addonChipClass(!!a.scotchgard)}" data-addon="scotchgard" data-id="${c.id}">Stain guard</button>
              <button type="button" class="iqAddon ${addonChipClass(!!a.deodorise)}" data-addon="deodorise" data-id="${c.id}">Deodorise</button>
              <button type="button" class="iqAddon ${addonChipClass(!!a.insecticide)}" data-addon="insecticide" data-id="${c.id}">Insecticide</button>
            </div>

            <div class="mt-3 text-[11px] text-slate-500">Add ons apply per selected item</div>
          </div>
        `;
      }

      function render() {
        els.carpetsGrid.innerHTML = PRICES.carpets.map(cardHtml).join("");
        els.upholsteryGrid.innerHTML = PRICES.upholstery.map(cardHtml).join("");

        const wireWithin = (root) => {
          root.querySelectorAll(".iqPlus").forEach(btn => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              const it = getItem(id);
              it.qty = Math.max(0, Math.min(99, (Number(it.qty)||0) + 1));

              // apply any master add ons to new items
              Object.keys(state.addonOn).forEach(k => {
                if (state.addonOn[k]) it.addons[k] = true;
              });

              root.querySelector(`[data-qty="${id}"]`).textContent = it.qty;
              syncOutputs(true);
            });
          });

          root.querySelectorAll(".iqMinus").forEach(btn => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              const it = getItem(id);
              it.qty = Math.max(0, Math.min(99, (Number(it.qty)||0) - 1));

              // if qty hits zero, keep add ons remembered, but it will not count
              root.querySelector(`[data-qty="${id}"]`).textContent = it.qty;
              syncOutputs(true);
            });
          });

          root.querySelectorAll(".iqAddon").forEach(btn => {
            btn.addEventListener("click", () => {
              const id = btn.getAttribute("data-id");
              const addon = btn.getAttribute("data-addon");
              const it = getItem(id);

              // if they toggle an add on before qty, set qty to 1
              if (!it.qty) it.qty = 1;

              it.addons[addon] = !it.addons[addon];
              btn.className = "iqAddon iq-pill " + addonChipClass(it.addons[addon]);

              // sync qty badge in case it was auto set to 1
              const badge = document.querySelector(`[data-qty="${id}"]`);
              if (badge) badge.textContent = it.qty;

              syncOutputs(true);
            });
          });
        };

        wireWithin(els.carpetsGrid);
        wireWithin(els.upholsteryGrid);
      }

      function resetAll() {
        state.items = {};
        state.addonOn = { scotchgard:false, deodorise:false, insecticide:false };
        els.addonMasters.forEach(b => {
          const k = b.getAttribute("data-addon");
          b.className = addonMasterClass(false);
          state.addonOn[k] = false;
        });
        render();
        syncOutputs(true);
      }

      // Tabs
      els.tabs.forEach(btn => btn.addEventListener("click", () => setTab(btn.getAttribute("data-tab"))));

      // Master add ons
      els.addonMasters.forEach(btn => {
        btn.addEventListener("click", () => {
          const k = btn.getAttribute("data-addon");
          state.addonOn[k] = !state.addonOn[k];
          btn.className = addonMasterClass(state.addonOn[k]);

          // if master is on, apply to all already selected items
          if (state.addonOn[k]) {
            Object.keys(state.items).forEach(id => {
              if ((state.items[id]?.qty||0) > 0) {
                state.items[id].addons[k] = true;
              }
            });
          }

          render();
          syncOutputs(true);
        });
      });

      // Reset
      if (els.iqReset) els.iqReset.addEventListener("click", resetAll);

      // Copy selection
      const copyText = async () => {
        const text = buildSummary();
        try {
          await navigator.clipboard.writeText(text);
          if (els.iqCopy) {
            const old = els.iqCopy.textContent;
            els.iqCopy.textContent = "Copied";
            setTimeout(() => els.iqCopy.textContent = old, 900);
          }
          if (els.miniCopy) {
            const old2 = els.miniCopy.textContent;
            els.miniCopy.textContent = "Copied";
            setTimeout(() => els.miniCopy.textContent = old2, 900);
          }
        } catch (e) {
          alert("Could not copy. You can select the text in the box and copy it instead.");
        }
      };

      if (els.iqCopy) els.iqCopy.addEventListener("click", copyText);
      if (els.miniCopy) els.miniCopy.addEventListener("click", copyText);

      load();
      render();
      setTab(state.tab || "carpets");
      els.addonMasters.forEach(b => {
        const k = b.getAttribute("data-addon");
        b.className = addonMasterClass(!!state.addonOn[k]);
      });
      syncOutputs(false);

      // Keep the mini total in sync after page load
      setInterval(() => {
        const total = fmt(calcTotal());
        if (els.miniTotal && els.miniTotal.textContent !== total) els.miniTotal.textContent = total;
      }, 800);
    })();

    /* =========================
       REVIEWS SCRIPT (your original)
       ========================= */
    const REVIEWS = [
      { name:"Diana Roach", when:"2 weeks ago", stars:5, text:"Being new to the area we feel very fortunate to have chosen Paul of the Carpet Cleaning Company. From the 1st point of contact through to completion Paul was highly professional and very clear on pricing. We'd recently moved to a large house whose carpets were good quality but with a variety of unsightly stains. We were amazed at how Paul managed to remove all the incredibly stubborn stains which had seemingly ruined the carpets. We are so delighted with the results and have saved a fortune not having to replace them. Also more sustainable! We highly recommend Paul and what a lovely man he is too!" },
      { name:"Carolyn Mills", when:"a week ago", stars:5, text:"Paul did a super job. Very thorough. Moved all the furniture, left no stone unturned. Had a lot of carpet cleaning equipment to do a good job. Very pleasant hard working chap and reasonably priced for the work involved. Deserves the five stars." },
      { name:"kerrie glanville", when:"2 months ago", stars:5, text:"Paul visited me today 3/12/25.. did an absolute fantastic job on my stairs. They smell so fresh and look clean making my house feel cleaner! There is also a stain that he magically got out of my kids rooms that has been there years and â€¦More" },
      { name:"jac P", when:"3 months ago", stars:5, text:"Had my carpets cleaned by Paul a few days ago. I was reassured through out the whole process. Paul was punctual, polite and very knowledgeable as I asked about the products and equipment he used. My carpets look amazing ðŸ‘. Paul is a genuine professional and nice guy. I have recommended him to colleagues. Great experience from start to finish ðŸ‘Œ" },
      { name:"suzanne powell", when:"3 months ago", stars:5, text:"Had Paul over today to clean my large sofa. Lounge, stairs, landing and bedroom carpet. Superb service from start to finish. On time, polite and hardworking. Everything looks brand new!! Was thinking of having a new carpet, but so glad I contacted Paul, he's saved me a fortune!! Highly recommended and superb service." },
      { name:"Eluned Harrison", when:"a month ago", stars:5, text:"Great job done on our Lime green sofas this week, all stains gone and looking so much better and brighter. Paul took great care with the fabric and in ensuring I was happy with everything before leaving. Would highly recommend." },
      { name:"Patrick Maslin", when:"5 months ago", stars:5, text:"Paul provided a fantastic service. He was polite, friendly, on time and he worked quickly and efficiently. It was great value for money. My carpets were cleaned to a high professional standard and look amazing-so clean and bright. I highly recommend the Carpet Cleaning Company." },
      { name:"jenna Hamar", when:"2 months ago", stars:5, text:"Paul cleaned all the carpets in my holiday let on Thursday and did a fantastic job, carpets spotless and fresh smelling. Excellent service, explains the process and quotes a price before doing the job. Would highly recommend." },
      { name:"James Wilson", when:"4 months ago", stars:5, text:"I had my carpets cleaned by The Carpet Cleaning Company in Shrewsbury, and Iâ€™m really pleased with the results. Paul did an excellent job â€” he managed to remove all the stains and left the carpets looking like new. He was also very polite and professional throughout. Iâ€™d definitely recommend this company!" },
      { name:"David Beardsall", when:"3 months ago", stars:5, text:"Paul did a very thorough job and worked hard to fit around our schedule. We had moved into a house with some old and stained carpets so we had low expectations but Paul's excellent work made them look so much better. He went above and beyond with every detail, staying late to make sure he got rid of every stain. Would highly recommend his work" },
      { name:"kim nicholas", when:"a month ago", stars:5, text:"I had the carpet cleaning company come today at short notice . Paul was courteous and efficient and made my rug and carpet look brand new. Really happy with the results." },
      { name:"Harry Hancock Davies", when:"5 months ago", stars:5, text:"Paul did an excellent job on our carpets throughout our house. We had multiple stains caused by our pets and such stains were deeply engrained into our carpet as they had been there for some time. When Paul finished the carpet was like â€¦More" },
      { name:"Chris Atherton", when:"4 months ago", stars:5, text:"Paul was friendly, professional and efficient. He went above and beyond to make sure that the finished result was perfect. We couldnâ€™t be more pleased, the carpet looks like new. We will definitely be happy to have Paul back again when needed." },
      { name:"Gourmet Vanilla", when:"3 months ago", stars:5, text:"Paul from the Carpet Cleaning Company has just finished dry cleaning our big sofa and two armchairs in Ludlow. Heâ€™s done a brilliant job, what an improvement! Paul was a pleasure to deal with. Thank you!" },
      { name:"JANE WOOD", when:"3 months ago", stars:5, text:"Wouldnâ€™t highly recommend this company Paul was professional throughout his visit, he was punctual, he explained the process and the products he would use to achieve the best results as a hygienic clean was required. The results were fantastic, I would highly recommend this company, I am extremely impressed and pleased. Thanks Paul." },
      { name:"Alison Benbow", when:"a month ago", stars:5, text:"Paul tackled our farmhouse with enthusiasm , expertise and bags of energy for our big rooms . He has top quality machines and solutions and what a difference it has made . Thank you" },
      { name:"Ellie may darkes (ellie)", when:"4 months ago", stars:5, text:"Came in and cleaned my carpets, did a fantastic job carpets look brand new I highly recommend! Thank you Paul" },
      { name:"idris thomas", when:"5 months ago", stars:5, text:"Paul arrived today and cleaned three bedroom carpets, did a fantastic job would recommend.." },
      { name:"E Stock", when:"a month ago", stars:5, text:"Lovely chap - definitely recommend the deep clean! Worth the small amount extra for a job excellently done. High end equipment and professional service. Highly recommend ðŸ˜Š" },
      { name:"Ross Doodson", when:"a month ago", stars:5, text:"Superb and efficient service from start to finish. I thoroughly recommend Paul. A professional, trustworthy and high effective service. Thank you very much indeed!" },
      { name:"Jonathan Oâ€™Rourke", when:"7 months ago", stars:5, text:"Amazing service provided and will definitely be using again. My carpets and sofa look brand new for a very reasonable price. Canâ€™t recommend enough." },
      { name:"Bodhi Hughes", when:"4 months ago", stars:5, text:"The carpet cleaning company are true professionals. My expectations with what could be done with my carpets was far exceeded. Thank you so much" },
      { name:"Donna Jones", when:"a month ago", stars:5, text:"Absolutely amazing service carried out by Paul!\n\nPaul carried out a carpet clean at Shrewsbury and done a amazing job!!" },
      { name:"Melanie Riches", when:"3 months ago", stars:5, text:"Very trustworthy, professional and reliable service. Would highly recommend, carpet and sofa came up as as new." },
      { name:"Jenny James", when:"2 months ago", stars:5, text:"Very impressed with Paul's prompt and effective service - he got rid of everything including the impossible!" },
      { name:"Robin Nicholas", when:"8 months ago", stars:5, text:"Saved a fortune, was going to get new carpets until a friend in Ludlow recommended this company. The carpets are like new. An excellent Company." },
      { name:"Caroline Martin", when:"8 months ago", stars:5, text:"So happy with this company; Paul is chatty and approachable, knows his business very well and does a thorough job for a very reasonable price. No hesitation in recommending him." },
      { name:"Christine Bourne", when:"7 months ago", stars:5, text:"An excellent job carried out very professionally. Really pleased with three piece suite and carpets. Ludlow should be proud of itâ€™s trades people." },
      { name:"Victor Munsanje", when:"6 months ago", stars:5, text:"Excellent service, will definitely hire them again. If you are looking for a professional service, honest and sincere, you are here." },
      { name:"carol rowley", when:"4 months ago", stars:5, text:"Efficient,friendly and carpet looks new again. Would definitely recommend ðŸ‘Œ" },
      { name:"Chris Jennings", when:"4 months ago", stars:5, text:"Very good service from start to finish, would highly recommend." },
      { name:"Anne Douthwaite", when:"5 hours ago", stars:5, text:"Excellent service. Can highly recommend! Two rugs cleaned and they look brand new again! Very reasonably priced and will definitely use again. Thank you!" }
    ];

    function starString(n){
      const r = Math.max(0, Math.min(5, Math.round(Number(n) || 0)));
      return "â˜…â˜…â˜…â˜…â˜…".slice(0, r) + "â˜†â˜†â˜†â˜†â˜†".slice(0, 5 - r);
    }

    function escapeHtml(s){
      return String(s || "").replace(/[&<>"']/g, (m) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[m]));
    }

    function makePreview(text, maxChars){
      const t = String(text || "").replace(/\s+/g, " ").trim();
      if (t.length <= maxChars) return t;
      return t.slice(0, maxChars).trimEnd() + "â€¦";
    }

    function renderReviewCard(r, idx){
      const full = escapeHtml(r.text);
      const preview = escapeHtml(makePreview(r.text, 220));
      const name = escapeHtml(r.name);
      const when = escapeHtml(r.when || "");
      const stars = starString(r.stars || 5);

      return `
        <article class="rev-card relative rounded-3xl border border-emerald-200 bg-white shadow-soft p-6 lift"
                 data-review-idx="${idx}">
          <div class="absolute pointer-events-none inset-0 rounded-3xl"
               style="box-shadow: 0 0 0 1px rgba(16,185,129,.08) inset;"></div>

          <div class="flex items-start justify-between gap-4 relative">
            <div>
              <div class="font-extrabold text-slate-900">${name}</div>
              <div class="text-xs text-slate-500 mt-0.5">${when}</div>
            </div>
            <div class="text-amber-500 text-sm">${stars}</div>
          </div>

          <div class="mt-3 text-sm text-slate-700 relative">
            <div class="reviewText clamp-3" id="reviewText_${idx}"
                 data-preview="${preview}"
                 data-full="${full}">${preview}</div>
          </div>

          <div class="mt-4 flex items-center justify-between gap-3 relative">
            <div class="text-xs text-emerald-700 font-semibold">Genuine Google review</div>
            <button type="button"
              class="toggleBtn text-xs font-extrabold text-slate-900 hover:text-emerald-700"
              onclick="toggleFullReview(${idx})">
              Read full review
            </button>
          </div>
        </article>
      `;
    }

    let shown = 0;
    const INITIAL_SHOW = 6;
    const LOAD_MORE = 10;

    function updateLoadMoreButton(){
      const btn = document.getElementById("loadMoreBtn");
      if (!btn) return;

      const remaining = REVIEWS.length - shown;

      if (remaining <= 0) {
        btn.textContent = "All reviews shown";
        btn.disabled = true;
        btn.classList.add("opacity-60");
        return;
      }

      const next = Math.min(LOAD_MORE, remaining);
      btn.textContent = `Load ${next} more reviews`;
      btn.disabled = false;
      btn.classList.remove("opacity-60");
    }

    function paintReviews(count){
      const grid = document.getElementById("reviewsGrid");
      if (!grid) return;

      const toShow = Math.min(count, REVIEWS.length);
      let html = "";
      for (let i = 0; i < toShow; i++){
        html += renderReviewCard(REVIEWS[i], i);
      }
      grid.innerHTML = html;
      shown = toShow;
      updateLoadMoreButton();
    }

    window.toggleFullReview = function(idx){
      const el = document.getElementById("reviewText_" + idx);
      if (!el) return;

      const card = document.querySelector(`[data-review-idx="${idx}"]`);
      const btn = card ? card.querySelector(".toggleBtn") : null;

      const isClamped = el.classList.contains("clamp-3");
      if (isClamped){
        el.classList.remove("clamp-3");
        el.innerHTML = el.getAttribute("data-full") || el.innerHTML;
        if (btn) btn.textContent = "Collapse";
      } else {
        el.classList.add("clamp-3");
        el.innerHTML = el.getAttribute("data-preview") || el.innerHTML;
        if (btn) btn.textContent = "Read full review";
      }
    };

    function expandAll(){
      for (let i = 0; i < shown; i++){
        const el = document.getElementById("reviewText_" + i);
        if (!el) continue;
        el.classList.remove("clamp-3");
        el.innerHTML = el.getAttribute("data-full") || el.innerHTML;

        const card = document.querySelector(`[data-review-idx="${i}"]`);
        const btn = card ? card.querySelector(".toggleBtn") : null;
        if (btn) btn.textContent = "Collapse";
      }
    }

    function collapseAll(){
      for (let i = 0; i < shown; i++){
        const el = document.getElementById("reviewText_" + i);
        if (!el) continue;
        el.classList.add("clamp-3");
        el.innerHTML = el.getAttribute("data-preview") || el.innerHTML;

        const card = document.querySelector(`[data-review-idx="${i}"]`);
        const btn = card ? card.querySelector(".toggleBtn") : null;
        if (btn) btn.textContent = "Read full review";
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      paintReviews(INITIAL_SHOW);

      const loadBtn = document.getElementById("loadMoreBtn");
      if (loadBtn){
        loadBtn.addEventListener("click", () => paintReviews(shown + LOAD_MORE));
      }

      const expAll = document.getElementById("expandAllBtn");
      if (expAll) expAll.addEventListener("click", expandAll);

      const colAll = document.getElementById("collapseAllBtn");
      if (colAll) colAll.addEventListener("click", collapseAll);
    });
  </script>
</body>
</html>
